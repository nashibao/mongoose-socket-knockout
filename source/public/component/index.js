// Generated by CoffeeScript 1.6.2
var $, ApplicationViewModel, Model, app, message_schema, oa, oo, socket,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  _this = this;

require('knockout');

oo = ko.observable;

oa = ko.observableArray;

$ = require('jquery');

Model = require('./mongoose-socket-client').Model;

message_schema = require('./message/model').message_schema;

app = {};

app.message_schema = message_schema;

socket = Model.create_socket('test', io);

ApplicationViewModel = (function() {
  function ApplicationViewModel() {
    this.remove = __bind(this.remove, this);
    this.update = __bind(this.update, this);
    this.create = __bind(this.create, this);    this.messages_model = new Model('test', 'message', message_schema, socket);
    this.messages = this.messages_model.find({});
    this.count = this.messages_model.count({});
    this.content = oo("");
  }

  ApplicationViewModel.prototype.create = function() {
    var bl;
    bl = this.messages_model.create({
      'content': this.content()
    });
    if (bl) {
      return this.content("");
    }
  };

  ApplicationViewModel.prototype.update = function(doc) {
    return this.messages_model.update({
      '_id': doc._id
    }, doc);
  };

  ApplicationViewModel.prototype.remove = function(doc) {
    return this.messages_model.remove({
      '_id': doc._id
    });
  };

  return ApplicationViewModel;

})();

app.vm = new ApplicationViewModel;

$(document).ready(function() {
  return ko.applyBindings(app.vm);
});

module.exports = app;
